---
import BaseLayout from "./BaseLayout.astro";
import Header from "../components/Header.astro";

export interface Props {
  title: string;
  date: Date;
  tags: string[];
}

const { title, date, tags } = Astro.props;

const tagColors: Record<string, string> = {
  thoughts: "red-std",
  tech: "blue-std",
  design: "violet-std",
  personal: "orange-std",
};

const barColor = tagColors[tags[0]] || "yellow-std";

function formatDate(date: Date): string {
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
}
---

<BaseLayout title={`${title} | Joshua Motoaki Lau`}>
  <Header currentPage="blog" />

  <div id="cont" class="relative w-full min-h-screen overflow-hidden bg-light">
    <!-- SVG Noise Filter -->
    <svg style="position: absolute; width: 0; height: 0;">
      <defs>
        <filter id="pageNoise">
          <feTurbulence
            baseFrequency="0.3"
            numOctaves="3"
            stitchTiles="noStitch"></feTurbulence>
          <feColorMatrix type="saturate" values="0"></feColorMatrix>
        </filter>
      </defs>
    </svg>

    <!-- Article Content -->
    <article class="relative z-20 pt-24 md:pt-32 px-6 md:px-16 pb-24">
      <div class="max-w-3xl mx-auto">
        <!-- Header -->
        <header class="mb-12">
          <a href="/blog" class="nav-button text-h6 mb-4 inline-block">
            &larr; Back to Blog
          </a>

          <h1 class="text-h2 md:text-h1 font-regular leading-tight mb-4">
            {title}
          </h1>

          <div class="flex flex-wrap items-center gap-4 text-dark-hover">
            <time datetime={date.toISOString()}>
              {formatDate(date)}
            </time>

            <span class="hidden md:inline text-dark-hover/50">|</span>

            <div class="flex gap-2 flex-wrap">
              {
                tags.map((tag) => (
                  <span
                    class={`px-2 py-0.5 text-sm text-light bg-${tagColors[tag] || "yellow-std"}`}
                  >
                    {tag}
                  </span>
                ))
              }
            </div>
          </div>
        </header>

        <!-- Content -->
        <div class="prose">
          <slot />
        </div>
      </div>
    </article>
  </div>
</BaseLayout>

<style lang="postcss">
  #cont::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100%;
    min-height: 100vh;
    background: rgba(0, 0, 0, 0.1);
    filter: url(#pageNoise);
    opacity: 0.33;
    pointer-events: none;
    z-index: 50;
  }
</style>
